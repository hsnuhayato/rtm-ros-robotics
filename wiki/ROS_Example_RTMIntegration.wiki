#summary RTM-ROS Integration

<wiki:toc max_depth="2" />

* これまでの演習に参加していない人はリポジトリのインストールをしてください
{{{
rosinstall ~/prog/rtm-ros-robotics /opt/ros/diamondback http://rtm-ros-robotics.googlecode.com/svn/trunk/agentsystem_ros_tutorials/rtm-ros-robotics.rosinstall
}}}

= OpenHRP 環境の構築 =

== Java の確認 ==
{{{
$ rosdep install openhrp3
$ java -version
}}}
としたときに、
{{{
java version "1.6.0_24"
Java(TM) SE Runtime Environment (build 1.6.0_24-b07)
Java HotSpot(TM) 64-Bit Server VM (build 19.1-b02, mixed mode)
}}}
という風にJava(TM) SE が出ている必要があります．
この文字列が出てこない場合は、
{{{
$ sudo update-java-alternatives -s java-6-sun
}}}
とする

== Eclipseの設定:外部プラグインのインストール for RT System Editor ==
{{{
rosrun openhrp3 eclipse.sh
}}}
で立ち上がるeclipseを用いる

 Help -> Install New Softare -> Add -> Location
に
(10.04ユーザのみ）
http://download.eclipse.org/modeling/emf/updates/releases/
を追加し、EMF SDK 2.5.0 を選択しインストール.

(10.04/10.10ユーザ共通)
http://download.eclipse.org/tools/gef/updates/releases/
を追加し、GEF SDK 3.6.2をS選択しインストール．

ここまででRT System Editorが入る
{{{
rosrun openhrp3 eclipse.sh
}}}
でEclipseを立ち上げて、
 Window -> Open Perspective -> Other 
で、RT System Editorが入っていることが確認できる

== Eclipseの設定:外部プラグイン並びにのJava環境のインストール for GRXUI ==

(10.04/10.10ユーザ共通)
http://sourceforge.net/projects/java3d-eclipse/files/
から[http://downloads.sourceforge.net/project/java3d-eclipse/java3declipse%20plugin/20090302/java3declipse-20090302.zip?r=http%3A%2F%2Fsourceforge.net%2Fprojects%2Fjava3d-eclipse%2Ffiles%2F&ts=1307526535&use_mirror=jaist java3declipse-20090302.zip]をダウンロードし、
Help -> Install New Softare -> Add -> Archive
で、ダウンロードしたzipを選択、すべてを選択し、インストールする。

ダウンロードしたzipを選択する際のパスに日本語が含まれる（デスクトップなど）と、
MESSAGE No repository found
と認識されないので、例えば/tmpにダウンロードするなどパスはすべて英数字になるところにする

{{{
rosrun openhrp3 eclipse.sh
}}}
でEclipseを立ち上げて、
 Window -> Open Perspective -> Other 
で、GRXUIが入っていることを確認する。

== OpenHRPのコンパイル ==

{{{
rosmake openhrp3
}}}

== GRXUI 動作確認 ==
{{{
roslaunch mrobot_ros_bridge mrobot_simulator.launch 
}}}
として、視点を下に移すと台車ロボットが見えればOK。

 == 困ったときは... ==

* "LoadProject"で"FallingBoxes"を選択しても3DViewにモデルがでない。
{{{
 LD_LIBRARY_PATH=lib ./bin/openhrp-model-loader 
}}}
として
{{{
ready
}}}
がでているか確認。でていない場合は、
{{{
$ sudo /etc/init.d/omniorb4-nameserver stop
$ pkill -KILL omniNames
$ rtm-naming
}}}

* "FallingBoxes"のシミュレーションは表示されるけど、"SampleRobot_inHouse.xml"をロードしてもロボットが表示されない場合、
{{{
$ sudo rm /usr/lib/eclipse/plugins/com.generalrobotix.ui.grxui_0.9.8.jar
$ roscd openhrp3; rm installed
$ make
}}}