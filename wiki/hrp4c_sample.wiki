#summary One-sentence summary of this page.

= hrp4cの動かし方 =

== 初期化 ==
{{{
rosrun roseus roseus "hrp4c.l"
$ (setq *hrp4c* (hrp4))
$ (objects (list *hrp4c*))
}}}

== 関節を動かす方法 ==
{{{
(send *hrp4c* :reset-pose)   # reset-pose(初期姿勢）になる
(send *hrp4c* :angle-vector) # anglve-vector(関節角度列）を返す

(send *hrp4c* limb joint :joint-angle [ angle ]) # 1つの関節を動かす angleの単位系は degree または mm
;; :limb  joint
:torso :waist-p
       :waist-r
       :waist-y
:rarm :shoulder-p
      :shoulder-r
      :shoulder-y
      :elbow-p
      :wrist-y
      :wrist-r
      :hand-j0
      :hand-j1
:larm ;; :rarmと同じ
:rleg :crotch-y
      :crotch-r
      :crotch-p
      :knee-p
      :ankle-p
      :ankle-r
:lleg ;; :rlegと同じ
:head :neck-y
      :neck-r
      :neck-p
      :eyebrow-p
      :eyelid-p
      :eye-y
      :eye-p
      :mouth-p
      :upperlip-p
      :lowerlip-p
      :cheek-p
      
(send *hrp4c* :torso :waist-p :joint-angle 30) # :torso(胴体) :waist-p（前後方向）に 30deg 動く


(send *hrp4c* :angle-vector 
   #f(0.0 0.0 -13.953 28.142 -14.189 0.0 0.0 0.0 -13.953 28.142 -14.189 0.0
      0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0
      -12.976 -3.655 -0.68 -29.746 0.0 0.0 0.0 0.0 12.976 3.655 0.68 -29.746 0.0 0.0 0.0))
#すべての関節のパラメータを１度に制御する
#angle-vectorのパラメータの順序は(pprint (send-all (send *hrp4* :joint-list) :name))で確認できる
}}}

ルートリンク(腰リンク)を動かす
{{{
(send *hrp4c* :translate (float-vector 0 0 450))
(send *hrp4c* :rotate (deg2rad 45) :y)
(send *hrp4c* :newcoords (make-coords :pos (float-vector 0 0 450) :rpy (list 0 (deg2rad 45) 0)))
}}}

逆運動学
{{{
(send *hrp4c* :limb :inverse-kinematics [coordinate]) #limbをcoordinate座標に持っていく
#coordinateの後ろに :debug-view とするとデバッグに利用できる


}}}

他のロボットも含めて、関節の対応は
{{{
roscd hrpsys_ros_bridge_tutorials/models
*.yaml
}}}
の中に書いてあります。

== 足を地面につける ==
{{{
(send *hrp4c* :fix-leg-to-coords (make-coords) '(:rleg :lleg)) 
# :rlegと:llegのend-coords座標系の中心が(make-coords)(<=原点座標)にあうようにする
}}}



== ビューワにロボットを表示する ==
{{{
(objects (list *hrp4c*))
}}}

== シミュレーターを起動する ==
{{{
roseusを立ち上げた後
irteusgl$ (load "package://pr2eus/robot-interface.l")
irteusgl$ (setq *ri* (instance robot-interface :init :robot *hrp4c*))
irteusgl$ (send *ri* :angle-vector (send *hrp4* :angle-vector) 10000) #10000msで動かす
}}}