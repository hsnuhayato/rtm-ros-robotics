#summary ナビゲーションのサンプル

<wiki:toc max_depth="2" />

= 概要 =
ここで紹介するナビゲーションのサンプルは，
http://www.ros.org/wiki/move_base_stage/Tutorials/stage%20and%20navigation%20stack
に基づきました．ただ，このwikiのページは情報が古いので参考程度に見て下さい．紹介するナビゲーションサンプルは上のリンクのwikiページを見なくとも，[ROS_Install]をみて，インストールし，setup.bashをsourceしていれば，あとはこのページを読み進めていけば実行できます．


= 準備 =
[ROS_Install]にしたがってROSと講義関連パッケージがインストールされていることが前提です．また，必要に応じて以下のパッケージをインストールしてください．
{{{
sudo apt-get install ros-fuerte-stage
sudo apt-get install ros-fuerte-navigation
}}}

= 実行 =
３つのターミナルを立ち上げます
まずは，1つ目で
{{{
roscore
}}}
として下さい．

次に2つ目のターミナルで
{{{
roslaunch move_base_stage_tutorial robot.launch
}}}
とします．
以下の様なPlayer/Stageの初期画面が現れると思います．
[http://rtm-ros-robotics.googlecode.com/svn/wiki/move_base_stage_tutorial_init.png]

また以下の[http://www.ros.org/wiki/rviz rviz]ビューワが表示されるはずです．もし表示されなければ，
最後に
{{{
rosrun rviz rviz -d `rospack find move_base_stage_tutorial`/config/rviz.vcg 
}}}
としてビューワを表示します．(エラーが出た場合は下記を参照)

rvizビューワで左上の`2D Nav Goal`を押して地図上の任意の場所をクリックすると
その場所まで移動します．
[http://rtm-ros-robotics.googlecode.com/svn/wiki/move_base_stage_tutorial_rviz.png]

また，
{{{
rosrun pr2_teleop teleop_pr2_keyboard 
}}}
とすると，速度指令を送ることが出来ます．

== rvizでエラーが出た場合の対応 == 
 * rosmake rviz を実行する
 * export OGRE_RTT_MODE=Copy として RTTモードをCopyに変更する 
 * rviz に --sync オプションを付けて実行する

= プログラミング =

速度指令あるいは，目標位置を送るプログラムは
http://code.google.com/p/rtm-ros-robotics/source/browse/#svn%2Ftrunk%2Fagentsystem_ros_tutorials%2Fmove_base_stage_tutorial%2Fscript
にあります．それぞれ，[http://www.ros.org/wiki/rospy/Tutorials rospy], [http://www.ros.org/wiki/actionlib actionlib]の知識を前提としています．


速度指令プログラムは
{{{
roscd pr2_teleop
cat src/teleop_pr2_keyboard.cpp
}}}
をみるとよい．