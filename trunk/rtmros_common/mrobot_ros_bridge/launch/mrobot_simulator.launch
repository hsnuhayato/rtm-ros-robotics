<launch>
  <!-- BEGIN:openrtm setting -->
  <arg name="nameserver" default="localhost" />
  <env name="RTCTREE_NAMESERVERS" value="$(arg nameserver)" />
  <arg name="openrtm_args" value='-o "corba.nameservers:$(arg nameserver):2809" -o "naming.formats:%n.rtc" -o "logger.file_name:/tmp/rtc%p.log"' />
  <arg name="openrtm_ext_args" value='$(arg openrtm_args) -o "exec_cxt.periodic.type: SynchExtTriggerEC"' />
  <!-- END:openrtm setting -->
  <node pkg="openhrp3" name="grxui" type="grxui.sh"
	args="$(find mrobot_ros_bridge)/launch/SimulationProject.xml"/>
  <node name = "IISMobileRobotControllerComp"
	pkg  = "mrobot_ros_bridge"
	type = "IISMobileRobotControllerComp"
	args = "$(arg openrtm_ext_args)"
	output = "screen"/>
  <node name = "openhrp_controller_bridge"
	pkg  = "openhrp3"
	type = "openhrp-controller-bridge"
	args = "--server-name IISMobileRobotControllerComp
		--out-port angle:JOINT_VALUE
		--out-port velocity:JOINT_VELOCITY
		--in-port torque:JOINT_TORQUE
		$(arg openrtm_ext_args)"
	output = "screen"/>
  <node name = "MobileRobotROSBridgeComp"
	pkg  = "mrobot_ros_bridge"
	type = "MobileRobotROSBridgeComp"
	args = "$(arg openrtm_args)"
	output = "screen"/>
  <node pkg="pr2_teleop"
	type="teleop_pr2_keyboard"
	name="teleop_pr2_keyboard" output="screen"
	launch-prefix="xterm -e"/>


  <!-- BEGIN:openrtm connection -->
  <node name="rtmlaunch" pkg="openrtm" type="rtmlaunch.py" args="$(find mrobot_ros_bridge)/launch/mrobot_simulator.launch" output = "screen"/>
  <rtconnect from="IISMobileRobotController0.rtc:torque" to="IISMobileRobotControllerComp(Robot)0.rtc:torque" />
  <rtconnect from="IISMobileRobotControllerComp(Robot)0.rtc:velocity" to="IISMobileRobotController0.rtc:velocity" />
  <rtconnect from="IISMobileRobotControllerComp(Robot)0.rtc:angle" to="IISMobileRobotController0.rtc:angle" />
  <rtconnect from="IISMobileRobotController0.rtc:out" to="MobileRobotROSBridge0.rtc:in" />
  <rtconnect from="MobileRobotROSBridge0.rtc:out" to="IISMobileRobotController0.rtc:in" />
  <rtactivate component="IISMobileRobotController0.rtc" />
  <rtactivate component="MobileRobotROSBridge0.rtc" />
  <!-- END:openrtm connection -->

  <sphinxdoc><![CDATA[
This script starts mobile robot simulator and keyboard teloep interface
  ]]></sphinxdoc>

</launch>